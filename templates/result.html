<!doctype html>
<html lang="ja">
<head>
    <meta charset="utf-8">
    <title>検索結果</title>
    <style>
        #map { height: 500px; margin: 20px 0; }
        table, th, td { border: 1px solid gray; border-collapse: collapse; padding: 5px; }
        th { background-color: #f0f0f0; }
    </style>
</head>
<body>
  <h1>{{ selected_area or "全地域" }} の交通事故・規制分析結果</h1>

  {% if data %}
    <div id="map">{{ map_html|safe }}</div>

    <table>
      <thead>
        <tr>
          <th>交差点名</th>
          <th>事故件数</th>
          <th>サイクル長</th>
          <th>スプリット(＃1〜6)</th>
        </tr>
      </thead>
      <tbody>
        {% for row in data %}
        <tr>
          <td>{{ row['交差点名称(踏切名含む)'] }}</td>
          <td>{{ row['事故件数'] }}</td>
          <td>{{ row.get('サイクル長', '') }}</td>
          <td>{{ row.get('スプリット＃１','') }},
              {{ row.get('スプリット＃２','') }},
              {{ row.get('スプリット＃３','') }},
              {{ row.get('スプリット＃４','') }},
              {{ row.get('スプリット＃５','') }},
              {{ row.get('スプリット＃６','') }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p>該当するデータがありません。</p>
  {% endif %}

  <p><a href="/">戻る</a></p>
</body>
</html>
